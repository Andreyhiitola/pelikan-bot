#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
================================================================================
  –†–ï–î–ê–ö–¢–û–† –û–¢–ó–´–í–û–í - –ü–µ–ª–∏–∫–∞–Ω –ê–ª–∞–∫–æ–ª—å Hotel
================================================================================

–ß–¢–û –≠–¢–û:
    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞–º–∏ –≥–æ—Å—Ç–µ–π –æ—Ç–µ–ª—è.
    –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –æ—Ç–∑—ã–≤—ã –±–µ–∑ –∑–Ω–∞–Ω–∏—è SQL.

–î–õ–Ø –ß–ï–ì–û:
    - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤ –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
    - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º—ë–Ω, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –æ—Ü–µ–Ω–æ–∫
    - –ü—É–±–ª–∏–∫–∞—Ü–∏—è/—Å–Ω—è—Ç–∏–µ —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤
    - –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ (–æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
    - –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤

–ö–ê–ö –ü–û–õ–¨–ó–û–í–ê–¢–¨–°–Ø:
    1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS:
       ssh root@85.192.40.138
    
    2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
       python3 ~/pelikan-bot/edit_reviews.py
    
    3. –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–∑ –º–µ–Ω—é:
       1 - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã (—Å–ø–∏—Å–æ–∫ —Å ID)
       2 - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç–∑—ã–≤ (–≤–≤–µ–¥–∏—Ç–µ ID)
       3 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤ (–≤–≤–µ–¥–∏—Ç–µ ID)
       4 - –£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤ (–≤–≤–µ–¥–∏—Ç–µ ID)
       0 - –í—ã—Ö–æ–¥
    
    4. –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:
       - –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è (–∫–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ)
       - –ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã
       - –ü–ª—é—Å—ã (—á—Ç–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å)
       - –ú–∏–Ω—É—Å—ã (—á—Ç–æ –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å)
       - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–±—â–∏–π –æ—Ç–∑—ã–≤)
       - –ü—É–±–ª–∏–∫–∞—Ü–∏—é (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç–µ –∏–ª–∏ –Ω–µ—Ç)
       - –°—Ç–∞—Ç—É—Å (pending/approved/rejected)

–í–ê–ñ–ù–û:
    - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: /root/pelikan-bot/data/orders.db
    - –¢–∞–±–ª–∏—Ü–∞ –æ—Ç–∑—ã–≤–æ–≤: reviews
    - –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    - –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!

–°–¢–ê–¢–£–°–´ –û–¢–ó–´–í–û–í:
    - pending: –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–Ω–µ –≤–∏–¥–µ–Ω –Ω–∞ —Å–∞–π—Ç–µ)
    - approved: –û–¥–æ–±—Ä–µ–Ω (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω)
    - rejected: –û—Ç–∫–ª–æ–Ω—ë–Ω (–Ω–µ –≤–∏–¥–µ–Ω –Ω–∞ —Å–∞–π—Ç–µ)

–ü–£–ë–õ–ò–ö–ê–¶–ò–Ø:
    - is_published = 0: –û—Ç–∑—ã–≤ –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ
    - is_published = 1: –û—Ç–∑—ã–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ
    
    –ß—Ç–æ–±—ã –æ—Ç–∑—ã–≤ –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–∞–π—Ç–µ, –Ω—É–∂–Ω–æ:
    1. –°—Ç–∞—Ç—É—Å = approved
    2. is_published = 1

–ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:
    # –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤
    –í—ã–±–µ—Ä–∏—Ç–µ: 1
    
    # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤ #2
    –í—ã–±–µ—Ä–∏—Ç–µ: 2
    ID –æ—Ç–∑—ã–≤–∞: 2
    
    # –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è –≤ –æ—Ç–∑—ã–≤–µ #1
    –í—ã–±–µ—Ä–∏—Ç–µ: 3
    ID –æ—Ç–∑—ã–≤–∞: 1
    –ß—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º: 1
    –ù–æ–≤–æ–µ –∏–º—è: –ê–Ω–¥—Ä–µ–π –°.
    
    # –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤ #1
    –í—ã–±–µ—Ä–∏—Ç–µ: 3
    ID –æ—Ç–∑—ã–≤–∞: 1
    –ß—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º: 6
    
    # –£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤ #3
    –í—ã–±–µ—Ä–∏—Ç–µ: 4
    ID –æ—Ç–∑—ã–≤–∞: 3
    –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: yes

–ê–í–¢–û–†: –°–æ–∑–¥–∞–Ω–æ –¥–ª—è Pelikan Alakol Hotel Bot
–î–ê–¢–ê: –Ø–Ω–≤–∞—Ä—å 2026
================================================================================
"""

import sqlite3
import sys

DB_PATH = '/root/pelikan-bot/data/orders.db'

def show_reviews():
    """–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã"""
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    cursor.execute("""
        SELECT id, guest_name, display_name, room_number, status, is_published 
        FROM reviews 
        ORDER BY id
    """)
    
    print("\n" + "="*80)
    print("ID | –ò–º—è –≥–æ—Å—Ç—è      | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ  | –ö–æ–º–Ω–∞—Ç–∞ | –°—Ç–∞—Ç—É—Å   | –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω")
    print("="*80)
    
    for row in cursor.fetchall():
        pub = "–î–ê" if row[5] == 1 else "–ù–ï–¢"
        print(f"{row[0]:<2} | {row[1]:<14} | {row[2] or '–Ω–µ –∑–∞–¥–∞–Ω–æ':<13} | {row[3] or '-':<7} | {row[4]:<8} | {pub}")
    
    print("="*80 + "\n")
    conn.close()

def view_review(review_id):
    """–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –æ—Ç–∑—ã–≤"""
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM reviews WHERE id = ?", (review_id,))
    row = cursor.fetchone()
    
    if not row:
        print(f"‚ùå –û—Ç–∑—ã–≤ #{review_id} –Ω–µ –Ω–∞–π–¥–µ–Ω")
        conn.close()
        return
    
    print(f"""
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  –û–¢–ó–´–í #{row[0]}
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –ò–º—è –≥–æ—Å—Ç—è: {row[3]}
‚ïë  –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è: {row[17] or '–Ω–µ –∑–∞–¥–∞–Ω–æ'}
‚ïë  –ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã: {row[4] or '–Ω–µ —É–∫–∞–∑–∞–Ω'}
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –û–¶–ï–ù–ö–ò (1-10):
‚ïë  ‚Ä¢ –ß–∏—Å—Ç–æ—Ç–∞: {row[5]}  ‚Ä¢ –ö–æ–º—Ñ–æ—Ä—Ç: {row[6]}  ‚Ä¢ –õ–æ–∫–∞—Ü–∏—è: {row[7]}
‚ïë  ‚Ä¢ –£–¥–æ–±—Å—Ç–≤–∞: {row[8]}  ‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª: {row[9]}  ‚Ä¢ –¶–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ: {row[10]}
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –ü–õ–Æ–°–´: {row[11] or '–Ω–µ —É–∫–∞–∑–∞–Ω–æ'}
‚ïë  –ú–ò–ù–£–°–´: {row[12] or '–Ω–µ —É–∫–∞–∑–∞–Ω–æ'}
‚ïë  –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô: {row[13] or '–Ω–µ —É–∫–∞–∑–∞–Ω–æ'}
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  –°—Ç–∞—Ç—É—Å: {row[14]}
‚ïë  –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω: {'–î–ê' if row[18] == 1 else '–ù–ï–¢'}
‚ïë  –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {row[15]}
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
    """)
    conn.close()

def edit_review(review_id):
    """–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤"""
    view_review(review_id)
    
    print("\n–ß—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º?")
    print("1. –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è")
    print("2. –ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã")
    print("3. –ü–ª—é—Å—ã")
    print("4. –ú–∏–Ω—É—Å—ã")
    print("5. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π")
    print("6. –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å/—Å–Ω—è—Ç—å —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏")
    print("7. –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å")
    print("0. –ù–∞–∑–∞–¥")
    
    choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ (0-7): ").strip()
    
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    if choice == '1':
        new_value = input("–ù–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è: ").strip()
        cursor.execute("UPDATE reviews SET display_name = ? WHERE id = ?", (new_value, review_id))
        print(f"‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ '{new_value}'")
    
    elif choice == '2':
        new_value = input("–ù–æ–≤—ã–π –Ω–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã: ").strip()
        cursor.execute("UPDATE reviews SET room_number = ? WHERE id = ?", (new_value, review_id))
        print(f"‚úÖ –ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ '{new_value}'")
    
    elif choice == '3':
        new_value = input("–ù–æ–≤—ã–µ –ø–ª—é—Å—ã: ").strip()
        cursor.execute("UPDATE reviews SET pros = ? WHERE id = ?", (new_value, review_id))
        print(f"‚úÖ –ü–ª—é—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã")
    
    elif choice == '4':
        new_value = input("–ù–æ–≤—ã–µ –º–∏–Ω—É—Å—ã: ").strip()
        cursor.execute("UPDATE reviews SET cons = ? WHERE id = ?", (new_value, review_id))
        print(f"‚úÖ –ú–∏–Ω—É—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã")
    
    elif choice == '5':
        new_value = input("–ù–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ").strip()
        cursor.execute("UPDATE reviews SET comment = ? WHERE id = ?", (new_value, review_id))
        print(f"‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ–±–Ω–æ–≤–ª—ë–Ω")
    
    elif choice == '6':
        current = cursor.execute("SELECT is_published FROM reviews WHERE id = ?", (review_id,)).fetchone()[0]
        new_value = 0 if current == 1 else 1
        cursor.execute("UPDATE reviews SET is_published = ? WHERE id = ?", (new_value, review_id))
        print(f"‚úÖ –û—Ç–∑—ã–≤ {'–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω' if new_value == 1 else '—Å–Ω—è—Ç —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏'}")
    
    elif choice == '7':
        print("\n1. pending (–Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏)")
        print("2. approved (–æ–¥–æ–±—Ä–µ–Ω)")
        print("3. rejected (–æ—Ç–∫–ª–æ–Ω—ë–Ω)")
        status_choice = input("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å (1-3): ").strip()
        statuses = {'1': 'pending', '2': 'approved', '3': 'rejected'}
        if status_choice in statuses:
            cursor.execute("UPDATE reviews SET status = ? WHERE id = ?", (statuses[status_choice], review_id))
            print(f"‚úÖ –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ '{statuses[status_choice]}'")
    
    conn.commit()
    conn.close()

def delete_review(review_id):
    """–£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤"""
    view_review(review_id)
    confirm = input("\n‚ö†Ô∏è  –£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –æ—Ç–∑—ã–≤ –ù–ê–í–°–ï–ì–î–ê? (yes/no): ").strip().lower()
    
    if confirm == 'yes':
        conn = sqlite3.connect(DB_PATH)
        cursor = conn.cursor()
        cursor.execute("DELETE FROM reviews WHERE id = ?", (review_id,))
        conn.commit()
        conn.close()
        print(f"‚úÖ –û—Ç–∑—ã–≤ #{review_id} —É–¥–∞–ª—ë–Ω")
    else:
        print("‚ùå –û—Ç–º–µ–Ω–∞")

def main():
    while True:
        print("\n" + "="*50)
        print("  –†–ï–î–ê–ö–¢–û–† –û–¢–ó–´–í–û–í - –ü–µ–ª–∏–∫–∞–Ω –ê–ª–∞–∫–æ–ª—å")
        print("="*50)
        print("1. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã")
        print("2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤")
        print("3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∑—ã–≤")
        print("4. –£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤")
        print("0. –í—ã—Ö–æ–¥")
        print("="*50)
        
        choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (0-4): ").strip()
        
        if choice == '1':
            show_reviews()
        
        elif choice == '2':
            review_id = input("ID –æ—Ç–∑—ã–≤–∞: ").strip()
            if review_id.isdigit():
                view_review(int(review_id))
            else:
                print("‚ùå –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ")
        
        elif choice == '3':
            review_id = input("ID –æ—Ç–∑—ã–≤–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ").strip()
            if review_id.isdigit():
                edit_review(int(review_id))
            else:
                print("‚ùå –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ")
        
        elif choice == '4':
            review_id = input("ID –æ—Ç–∑—ã–≤–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: ").strip()
            if review_id.isdigit():
                delete_review(int(review_id))
            else:
                print("‚ùå –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ")
        
        elif choice == '0':
            print("üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            sys.exit(0)
        
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä")

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\nüëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
        sys.exit(0)
